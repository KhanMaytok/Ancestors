NAMESPACE = ACS

### "REGULAR" duels start here...
# Get challenged (sent from duel_decision )
character_event = {
    id = ACS.00409 # HFP.10095
    picture = GFX_evt_armory
    border = GFX_event_normal_frame_war    
    desc = ACS_00409_DESC
	is_triggered_only = yes
    
    immediate = {
        if = {
            limit = { NOT = { has_character_modifier = recent_duel_timer } }
            add_character_modifier = {
                modifier = recent_duel_timer
                hidden = yes
                months = 3
            }
        }
        event_target:combatant_1 = { #combatant_1/attacker
            if = {
                limit = { NOT = { has_character_modifier = recent_duel_timer } }
                #special circumstances, like initiation duel, etc
                add_character_modifier = { #OUTCOMMENT FOR TESTING PURPOSES
                    modifier = recent_duel_timer
                    hidden = yes
                    months = 3
                }
            }
        }
    }
    
    option = { #Challenge accepted
        name = EVTOPTA_WOL_11000
        clr_character_flag = flag_duel_no_backsies
        ai_chance = {
            factor = 100
        }

         event_target:combatant_1 = {
            character_event = { id = ACS.00410 }
        }
        set_character_flag = add_duel_xp
        clr_character_flag = punish_declining
        ai_chance = {
            factor = 80
        }
    }    
}

#  ACS.00410 - Start the duel - For the attacker (combatant_1)
character_event = {
    id =  ACS.00410 # HFP.10096
    is_triggered_only = yes
    picture = GFX_evt_armory
    border = GFX_event_normal_frame_war
    desc = EVTDESC_HFP_10096_bloodline
    
    option = {
        name = EVTOPTA_WOL_11001
        #FALLBACK:
        if = { #If FROM is no longer alive, clear relevant flags, etc...
            limit = { FROM = { NOT = { is_alive = yes } } }
            reset_warrior_lodge_joining_chain_effect = yes
            character_event = { id = HFP.10197 }
        }
        else = {
            hidden_effect = {
                set_character_flag = add_duel_xp
                reset_duel_timers_effect = yes
                character_event = { id = HFP.10100 } #Send hidden set-up of duel (from there: result)
				narrative_event = { id = ACS.00402 days = 3 }
            }
        }
        ai_chance = {
            factor = 100
        }
    }    
}
