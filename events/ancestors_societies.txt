NAMESPACE = ACS

# ACS.00200 - Spawn some characters for Pentaghast and Sakya
character_event = {
    id = ACS.00200
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        if = {
            limit = {
                has_character_flag = is_ancient_one
            }
            # Fill the tier 4 seats
            set_variable = { which = count value = 2 }
            while = {
                limit = {
                    check_variable = {
                        which = count
                        value = 1
                    }
                }
                subtract_variable = {
                    which = count
                    value = 1
                }
                create_character = {
                    random_traits = yes
                    female = yes
                }
                new_character = { join_society = sakya_society society_rank_up = 3 }

                create_character = {
                    random_traits = yes
                    female = no
                }
                new_character = { join_society = sakya_society society_rank_up = 3 }
            }
            # Fill the tier 3 seats
            set_variable = { which = count value = 25 }
            while = {
                limit = {
                    check_variable = {
                        which = count
                        value = 1
                    }
                }
                subtract_variable = {
                    which = count
                    value = 1
                }
                create_character = {
                    random_traits = yes
                    female = yes
                }
                new_character = { join_society = sakya_society society_rank_up = 2 }
            }
            # Fill the tier 2 seats
            set_variable = { which = count value = 25 }
            while = {
                limit = {
                    check_variable = {
                        which = count
                        value = 1
                    }
                }
                subtract_variable = {
                    which = count
                    value = 1
                }
                create_character = {
                    random_traits = yes
                    female = yes
                }
                new_character = { join_society = sakya_society society_rank_up = 1 }

                create_character = {
                    random_traits = yes
                    female = no
                }
                new_character = { join_society = sakya_society society_rank_up = 1 }            
            }

            # Fill the tier 1 seats
            set_variable = { which = count value = 50 }
            while = {
                limit = {
                    check_variable = {
                        which = count
                        value = 1
                    }
                }
                subtract_variable = {
                    which = count
                    value = 1
                }
                create_character = {
                    random_traits = yes
                    female = yes
                }
                new_character = { join_society = sakya_society }

                create_character = {
                    random_traits = yes
                    female = no
                }
                new_character = { join_society = sakya_society }            
            }  
        }

        # Fill the Pentaghast society
        if = {
            limit = {
                has_character_flag = is_olaf
            }
            create_character = {
                name="Gunnr"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Geirdriful"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Eir"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Kara"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Rota"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Olrun"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Gondul"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Hildr"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = no
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
            create_character = {
                name="Sigrun"
                trait = ambitious
			    trait = elusive_shadow
                trait = prevent_marriage
                female = yes
                culture = FROM
                religion = FROM
            }
            new_character = { join_society = pentaghast_society society_rank_up = 3 set_secret_religion = ishtar_religion }
        }        
    }
}

# ACS.00201 - TIER 4 pentaghast causes disasters
character_event = {
	id = ACS.00201
	is_triggered_only = yes
	hide_window = yes
	is_in_society = yes

	trigger = {
		society_member_of = pentaghast_society
		society_rank == 4
		is_landed = no
		prisoner = no
		is_incapable = no
	}

	immediate = {
		random_playable_ruler = {
			save_event_target_as = target_for_revolt
			location = {
				random_neighbor_province = {
					add_province_modifier = { name = visitated_by_pentaghast days = 60 }
				}
			}
		}
		ROOT = {
			move_character = event_target:target_for_revolt			
		}
	}	
}

# ACS.00202 - Trigger for a character interested in society
character_event = {
	id = ACS.00202
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_in_society = no
		OR = {
			interested_in_society = pentaghast_society
			interested_in_society = sakya_society
		}
	}

	immediate = {
		character_event = { id = ACS.00203 days = 30 random = 15 }
	}
}

#ACS.00203 - Select recluter
character_event = {
	id = ACS.00203
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		is_in_society = no
		OR = {
			interested_in_society = pentaghast_society
			interested_in_society = sakya_society
		}
	}

	immediate = {
		if = {
			limit = { prisoner = yes }
			repeat_event = { id = ACS.00203 days = 90 random = 640 }
			break = yes
		}
		#SAKYA
		if = {
			limit = {
				interested_in_society = sakya_society
				NOT = { has_character_flag = being_recruited_by_sakya }
			}

			random_society_member = {
				limit = {
					society_member_of = sakya_society
					is_society_grandmaster = no
				}
				save_event_target_as = sakya_recruiter
				character_event = { id = MNM.10012 }
			}
		}
		#PENTAGHAST
		if = {
			limit = {
				interested_in_society = pentaghast_society
				NOT = { has_character_flag = being_recruited_by_pentaghast }
			}
			random_society_member = {
				limit = {
					society_member_of = pentaghast_society
					is_society_grandmaster = no
				}
				save_event_target_as = satanists_recruiter
				# character_event = { id = MNM.10013 }
                character_event = { id = ACS.00204 }
			}
		}
	}	
}

# Setting up the flags for posible candidate
character_event = {
	id = ACS.00204
	hide_window = yes

	is_triggered_only = yes

	immediate = { 
		FROM = {
			set_character_flag = being_recruited_by_pentaghast
			# character_event = { id = MNM.7001 }
            character_event = { id = ACS.00205 }
		}
	}
}
